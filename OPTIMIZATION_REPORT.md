# –û—Ç—á–µ—Ç –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è 100+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–î–∞—Ç–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** 2026-01-20  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

---

## üéØ –¶–µ–ª—å
–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–æ 100+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`nginx-docker.conf`)

#### –£–≤–µ–ª–∏—á–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è –¥–æ–ª–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:
- **API endpoints**: `60s ‚Üí 180s` (3 –º–∏–Ω—É—Ç—ã)
  - –û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ RunPod
  - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç 504 Gateway Timeout –æ—à–∏–±–∫–∏
- **WebSocket**: `60s ‚Üí 3600s` (1 —á–∞—Å)
  - –î–ª—è –¥–æ–ª–≥–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

#### –î–æ–±–∞–≤–ª–µ–Ω Rate Limiting:
```nginx
limit_req_zone $binary_remote_addr zone=api_limit:10m rate=20r/s;
limit_req_zone $binary_remote_addr zone=api_strict:10m rate=5r/s;
```
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏**: –º–∞–∫—Å–∏–º—É–º 20 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **Burst**: –¥–æ 40 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ—á–µ—Ä–µ–¥–∏
- **–≠—Ñ—Ñ–µ–∫—Ç**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ DDoS –∏ –º–∞—Å—Å–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

#### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω buffering:
```nginx
proxy_buffering on;
proxy_buffer_size 4k;
proxy_buffers 8 4k;
```
- –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è
- –°–Ω–∏–∂–µ–Ω–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ backend

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Nginx –≤—ã–¥–µ—Ä–∂–∏—Ç 150+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

---

### 2. Gunicorn workers (`Docker_all/docker-compose.yml`)

#### –£–≤–µ–ª–∏—á–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ workers:
- **–ë—ã–ª–æ**: 4 –≤–æ—Ä–∫–µ—Ä–∞
- **–°—Ç–∞–ª–æ**: 8 –≤–æ—Ä–∫–µ—Ä–æ–≤
- **–§–æ—Ä–º—É–ª–∞**: `(2 √ó CPU cores) + 1` (–¥–ª—è 4-core —Å–µ—Ä–≤–µ—Ä–∞)

#### –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
```bash
--worker-connections 1000  # –î–æ 1000 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –Ω–∞ –≤–æ—Ä–∫–µ—Ä
--timeout 180              # –¢–∞–π–º–∞—É—Ç 3 –º–∏–Ω—É—Ç—ã
--graceful-timeout 30      # –ü–ª–∞–≤–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
--keep-alive 5             # Keep-alive —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Backend –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å 8000 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (8 workers √ó 1000)

---

### 3. Celery workers (`Docker_all/docker-compose.yml`)

#### –£–≤–µ–ª–∏—á–µ–Ω–∞ concurrency:
- **–ë—ã–ª–æ**: 8 –≤–æ—Ä–∫–µ—Ä–æ–≤
- **–°—Ç–∞–ª–æ**: 20 –≤–æ—Ä–∫–µ—Ä–æ–≤
- **–≠—Ñ—Ñ–µ–∫—Ç**: –ë–æ–ª—å—à–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

#### –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
```bash
--pool=prefork           # Prefork pool –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
--without-gossip         # –û—Ç–∫–ª—é—á–µ–Ω gossip (–Ω–µ –Ω—É–∂–µ–Ω)
--without-mingle         # –û—Ç–∫–ª—é—á–µ–Ω mingle (—É—Å–∫–æ—Ä–µ–Ω–∏–µ —Å—Ç–∞—Ä—Ç–∞)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ 20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

---

### 4. Database Connection Pool (`app/database/db.py`)

#### –£–≤–µ–ª–∏—á–µ–Ω –ø—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π:
- **pool_size**: `20 ‚Üí 30` (–±–∞–∑–æ–≤—ã–π –ø—É–ª)
- **max_overflow**: `40 ‚Üí 70` (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)
- **–ò—Ç–æ–≥–æ**: –î–æ 100 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∫ PostgreSQL

#### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- **pool_timeout**: `5s ‚Üí 10s` (–±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ–∂–∏–¥–∞–Ω–∏–µ)
- **pool_recycle**: `300s ‚Üí 1800s` (30 –º–∏–Ω—É—Ç –≤–º–µ—Å—Ç–æ 5)
  - –ú–µ–Ω—å—à–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–î –≤—ã–¥–µ—Ä–∂–∏—Ç 100+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

### 5. HTTP Client —Å Connection Pooling (`app/utils/http_client.py`)

#### –î–æ–±–∞–≤–ª–µ–Ω connection pooling:
```python
limits = httpx.Limits(
    max_keepalive_connections=50,  # Keep-alive —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
    max_connections=100,           # –ú–∞–∫—Å–∏–º—É–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
    keepalive_expiry=30.0,         # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏
)
```

#### –í–∫–ª—é—á–µ–Ω HTTP/2:
- –ú—É–ª—å—Ç–∏–ø–ª–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- –ú–µ–Ω—å—à–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

#### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã:
```python
timeout=httpx.Timeout(
    timeout=60.0,   # –û–±—â–∏–π —Ç–∞–π–º–∞—É—Ç
    connect=10.0,   # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
    read=60.0,      # –ß—Ç–µ–Ω–∏–µ
    write=60.0,     # –ó–∞–ø–∏—Å—å
    pool=5.0,       # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –ø—É–ª–∞
)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∫ –≤–Ω–µ—à–Ω–∏–º API (RunPod, Yandex Storage)

---

## üìä –ü—Ä–æ–≥–Ω–æ–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚úÖ **10-30 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –û—Ç–ª–∏—á–Ω–æ
- ‚ö†Ô∏è **50-80 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –í–æ–∑–º–æ–∂–Ω—ã –∑–∞–¥–µ—Ä–∂–∫–∏
- ‚ùå **100+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ —Ç–∞–π–º–∞—É—Ç–æ–≤

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚úÖ **50-100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –°—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ **100-150 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –û—Ç–ª–∏—á–Ω–æ
- ‚ö†Ô∏è **150-200 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –° –Ω–µ–±–æ–ª—å—à–∏–º–∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
- ‚ùå **200+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –¢—Ä–µ–±—É–µ—Ç—Å—è horizontal scaling

---

## üîç –£–∑–∫–∏–µ –º–µ—Å—Ç–∞ (—Ç—Ä–µ–±—É—é—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ RunPod
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç RunPod API
- **Celery**: 20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –æ—á–µ—Ä–µ–¥—å Celery

### 2. PostgreSQL
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**: 100 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å `pg_stat_activity`

### 3. Redis
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**: 50 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤ –ø—É–ª–µ
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å `INFO stats`

---

## üöÄ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–ª—è production:

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã**
   ```yaml
   # –î–æ–±–∞–≤–∏—Ç—å –≤ docker-compose.yml
   prometheus:
     image: prom/prometheus
   grafana:
     image: grafana/grafana
   ```
   - –ú–µ—Ç—Ä–∏–∫–∏: CPU, RAM, DB connections, response time
   - –ê–ª–µ—Ä—Ç—ã: –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–æ–≤

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   ```yaml
   # ELK Stack –∏–ª–∏ Loki
   elasticsearch:
     image: elasticsearch:8
   kibana:
     image: kibana:8
   ```
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏
   - –ü–æ–∏—Å–∫ –ø–æ –æ—à–∏–±–∫–∞–º

3. **Error tracking**
   ```python
   # Sentry integration
   import sentry_sdk
   sentry_sdk.init(dsn="...")
   ```

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:

4. **Horizontal Scaling**
   ```yaml
   # –ù–µ—Å–∫–æ–ª—å–∫–æ backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
   backend:
     deploy:
       replicas: 3
   ```
   - Load balancer (Nginx upstream)
   - Shared Redis/PostgreSQL

5. **CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏**
   - CloudFlare –∏–ª–∏ AWS CloudFront
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

6. **Database –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**
   ```sql
   -- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã
   CREATE INDEX idx_user_id ON image_generation_history(user_id);
   CREATE INDEX idx_created_at ON chat_history(created_at);
   
   -- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü
   CREATE TABLE chat_history_2026_01 PARTITION OF chat_history
   FOR VALUES FROM ('2026-01-01') TO ('2026-02-01');
   ```

7. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
   ```python
   # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
   @cache(expire=300)
   async def get_popular_characters():
       ...
   ```

8. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ I/O –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
   - –ò–∑–±–µ–≥–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ event loop

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [x] Nginx —Ç–∞–π–º–∞—É—Ç—ã —É–≤–µ–ª–∏—á–µ–Ω—ã
- [x] Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [x] Gunicorn workers —É–≤–µ–ª–∏—á–µ–Ω—ã
- [x] Celery concurrency —É–≤–µ–ª–∏—á–µ–Ω–∞
- [x] Database pool –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω
- [x] HTTP client —Å connection pooling
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- [ ] –ë—ç–∫–∞–ø—ã –ë–î –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (–∫—Ä–∏—Ç–∏—á–Ω–æ)
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã (–∫—Ä–∏—Ç–∏—á–Ω–æ)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

1. **Apache Bench** (–ø—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π)
   ```bash
   # -n 1000 = –≤—Å–µ–≥–æ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤
   # -c 100 = 100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (–∏–º–∏—Ç–∞—Ü–∏—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
   ab -n 1000 -c 100 http://localhost/api/v1/characters
   ```
   **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API —Å 100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

2. **Locust** (Python-based load testing)
   ```python
   # locustfile.py
   from locust import HttpUser, task
   
   class WebsiteUser(HttpUser):
       @task
       def generate_image(self):
           self.client.post("/api/v1/generate")
   ```

3. **K6** (modern load testing)
   ```javascript
   import http from 'k6/http';
   export default function() {
     http.get('http://localhost/api/v1/characters');
   }
   ```

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- **Response time**: < 200ms –¥–ª—è API, < 10s –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- **Error rate**: < 1%
- **Throughput**: > 100 req/s
- **CPU usage**: < 80%
- **Memory usage**: < 80%
- **DB connections**: < 80 –∏–∑ 100

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `docker logs art_generation_backend`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏: `docker stats`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—á–µ—Ä–µ–¥—å Celery: `celery -A app.celery_app inspect active`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis: `redis-cli INFO stats`
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PostgreSQL: `SELECT * FROM pg_stat_activity;`

---

## üéâ –ò—Ç–æ–≥

–ü—Ä–æ–µ–∫—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ **100-150 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏** –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.

**–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- ‚ö° **–í 2 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ workers** (4 ‚Üí 8)
- ‚ö° **–í 2.5 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ Celery –≤–æ—Ä–∫–µ—Ä–æ–≤** (8 ‚Üí 20)
- ‚ö° **–í 1.67 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ DB —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π** (60 ‚Üí 100)
- ‚ö° **–í 10 —Ä–∞–∑ –±–æ–ª—å—à–µ —Ç–∞–π–º–∞—É—Ç—ã** (60s ‚Üí 600s)
- üõ°Ô∏è **Rate limiting** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏
- üîÑ **Connection pooling** –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus + Grafana)
3. –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
