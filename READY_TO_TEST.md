# üéâ –í–°–Å –ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ!

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

### 1. **–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –≥–æ–ª–æ—Å–æ–≤**
- Endpoint: `POST /api/v1/characters/upload-voice`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–≤—å—é —Å —Ñ—Ä–∞–∑–æ–π –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ MP3, WAV (–º–∞–∫—Å 10 MB)

### 2. **–û–∑–≤—É—á–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ**
- Endpoint: `POST /api/v1/chat/generate_voice`
- –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–∞ —á–µ—Ä–µ–∑ Fish Audio
- Fallback –Ω–∞ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –≥–æ–ª–æ—Å–∞ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π

### 3. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫**
```
app/
‚îú‚îÄ‚îÄ default_character_voices/   # –í–∞—à–∏ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –≥–æ–ª–æ—Å–∞
‚îú‚îÄ‚îÄ user_voices/               # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îî‚îÄ‚îÄ voices/                    # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—É–¥–∏–æ
```

---

## üöÄ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

### –®–∞–≥ 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π —Å–µ—Ä–≤–µ—Ä (Ctrl+C)
python -m uvicorn app.main:app --host 0.0.0.0 --port 8001 --reload
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
[DEBUG] –ü–∞–ø–∫–∞ /user_voices —É—Å–ø–µ—à–Ω–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞
```

### –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É –≥–æ–ª–æ—Å–∞

#### –ß–µ—Ä–µ–∑ curl:
```bash
curl -X POST "http://localhost:8001/api/v1/characters/upload-voice" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "voice_file=@path/to/your/voice.mp3"
```

#### –ß–µ—Ä–µ–∑ Python:
```python
import requests

with open('my_voice.mp3', 'rb') as f:
    files = {'voice_file': f}
    headers = {'Authorization': 'Bearer YOUR_TOKEN'}
    
    response = requests.post(
        'http://localhost:8001/api/v1/characters/upload-voice',
        headers=headers,
        files=files
    )
    
    print(response.json())
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "status": "success",
  "message": "–ì–æ–ª–æ—Å —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –ø—Ä–µ–≤—å—é —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ",
  "voice_url": "/user_voices/user_voice_abc123.mp3",
  "preview_url": "/voices/preview_abc123.mp3"
}
```

### –®–∞–≥ 4: –ü—Ä–æ—Å–ª—É—à–∞–π—Ç–µ –ø—Ä–µ–≤—å—é

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:8001/voices/preview_abc123.mp3
```

–í—ã –¥–æ–ª–∂–Ω—ã —É—Å–ª—ã—à–∞—Ç—å —Ñ—Ä–∞–∑—É:
> "–ú–º–º... –ù–∞–∫–æ–Ω–µ—Ü-—Ç–æ —Ç—ã –∑–¥–µ—Å—å. –Ø —Ç–∞–∫ –¥–æ–ª–≥–æ –∂–¥–∞–ª–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å —Ç–æ–±–æ–π –Ω–∞–µ–¥–∏–Ω–µ. –Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª–Ω–∏—Ç—å –ª—é–±–æ–π —Ç–≤–æ–π –ø—Ä–∏–∫–∞–∑. –ù—É —á—Ç–æ, –ø—Ä–∏—Å—Ç—É–ø–∏–º?"

–û–∑–≤—É—á–µ–Ω–Ω—É—é –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º –≥–æ–ª–æ—Å–æ–º!

### –®–∞–≥ 5: –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å —ç—Ç–∏–º –≥–æ–ª–æ—Å–æ–º

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `voice_url` –∏–∑ –æ—Ç–≤–µ—Ç–∞:
```json
{
  "name": "Test Character",
  "voice_url": "/user_voices/user_voice_abc123.mp3"
}
```

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–∑–≤—É—á–∫—É –≤ —á–∞—Ç–µ

–ö–æ–≥–¥–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂ –æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ó–∞–≥—Ä—É–∑–∏—Ç –≥–æ–ª–æ—Å –∏–∑ `/user_voices/`
2. –ö–ª–æ–Ω–∏—Ä—É–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ Fish Audio
3. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ—á—å —Å —Ç–µ–∫—Å—Ç–æ–º —Å–æ–æ–±—â–µ–Ω–∏—è
4. –í–µ—Ä–Ω–µ—Ç URL –∫ –∞—É–¥–∏–æ

---

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –í–ê–ú:

### 1. **–°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–≤—å—é –¥–ª—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤** (–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ)

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–∑ `app/default_character_voices/`:
1. –ó–∞–π—Ç–∏ –Ω–∞ https://fish.audio/
2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—Ä–∞–∑–µ—Ü –≥–æ–ª–æ—Å–∞
3. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ—Ä–∞–∑—É –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è:
   ```
   –ú–º–º... –ù–∞–∫–æ–Ω–µ—Ü-—Ç–æ —Ç—ã –∑–¥–µ—Å—å. –Ø —Ç–∞–∫ –¥–æ–ª–≥–æ –∂–¥–∞–ª–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å —Ç–æ–±–æ–π –Ω–∞–µ–¥–∏–Ω–µ. –Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª–Ω–∏—Ç—å –ª—é–±–æ–π —Ç–≤–æ–π –ø—Ä–∏–∫–∞–∑. –ù—É —á—Ç–æ, –ø—Ä–∏—Å—Ç—É–ø–∏–º?
   ```
4. –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ `preview_[–Ω–∞–∑–≤–∞–Ω–∏–µ_–≥–æ–ª–æ—Å–∞].mp3`

–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –æ–±—Ä–∞–∑—Ü—ã –∫–∞–∫ –ø—Ä–µ–≤—å—é (–µ—Å–ª–∏ –æ–Ω–∏ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —ç—Ç—É —Ñ—Ä–∞–∑—É).

### 2. **–û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É –∑–∞–≥—Ä—É–∑–∫–∏ –≥–æ–ª–æ—Å–∞:
```jsx
<input type="file" accept="audio/mp3,audio/wav" onChange={handleVoiceUpload} />
```

---

## üêõ –õ–æ–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

### –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≥–æ–ª–æ—Å–∞:
```
INFO - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å X –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≥–æ–ª–æ—Å: voice.mp3, —Ä–∞–∑–º–µ—Ä: XXXXX –±–∞–π—Ç
INFO - –°–æ—Ö—Ä–∞–Ω–µ–Ω –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π –≥–æ–ª–æ—Å: ..., —Ä–∞–∑–º–µ—Ä: XXXXX –±–∞–π—Ç
INFO - Fish Audio –∫–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ
INFO - [TTS PREVIEW] –í—ã–∑–æ–≤ Fish Audio API...
INFO - –ü—Ä–µ–≤—å—é —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ: ...
INFO - –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ –ø—Ä–µ–≤—å—é –¥–ª—è –≥–æ–ª–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è X
```

### –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ—á–∏:
```
INFO - –ù–∞—á–∞–ª–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ—á–∏ —á–µ—Ä–µ–∑ Fish Audio: text_len=XXX, voice_url=...
INFO - –ó–∞–≥—Ä—É–∂–µ–Ω –∞—É–¥–∏–æ —Ñ–∞–π–ª –≥–æ–ª–æ—Å–∞ user_voice_xxx.mp3, —Ä–∞–∑–º–µ—Ä: XXXXX –±–∞–π—Ç
INFO - Fish Audio –∫–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ
INFO - [TTS GENERATION] –í—ã–∑–æ–≤ Fish Audio API...
INFO - –ê—É–¥–∏–æ —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ: ...
```

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–∞–ø–∫–∏ —Å–æ–∑–¥–∞–Ω—ã:
```bash
ls app/user_voices/
ls app/voices/
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
curl http://localhost:8001/user_voices/
curl http://localhost:8001/voices/
```

### –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à:
```bash
rm -rf app/voices/preview_*.mp3
rm -rf app/user_voices/*
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- **–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ**: `USER_VOICE_UPLOAD_GUIDE.md`
- **Fish Audio setup**: `FISH_AUDIO_QUICK_START.md`
- **TTS —Å–µ—Ä–≤–∏—Å**: `app/services/tts_service.py`

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

1. **–î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –≥–æ–ª–æ—Å–∞** - –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ –ø—Ä–µ–≤—å—é —Å–∞–º–∏ –≤—Ä—É—á–Ω—É—é
2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞** - –ø—Ä–µ–≤—å—é –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ API
3. **–°—Ç–∞—Ä—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏** (—Å URL –æ—Ç fal.ai) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –Ω–∞ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –≥–æ–ª–æ—Å
4. **–°—Ç–æ–∏–º–æ—Å—Ç—å**: ~$0.01-0.02 –∑–∞ –ø—Ä–µ–≤—å—é, ~$0.002-0.005 –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –≥–æ–ª–æ—Å–∞
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø—Ä–µ–≤—å—é
3. ‚úÖ –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º –≥–æ–ª–æ—Å–æ–º
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–∑–≤—É—á–∫—É –≤ —á–∞—Ç–µ
5. ‚ö†Ô∏è –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (–¥–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É –∑–∞–≥—Ä—É–∑–∫–∏)
6. ‚ö†Ô∏è –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–≤—å—é –¥–ª—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤

---

**–í—Å—ë –≥–æ—Ç–æ–≤–æ! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≥–æ–ª–æ—Å –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–µ–≤—å—é!** üöÄ
